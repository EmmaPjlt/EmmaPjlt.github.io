"use strict";(self.webpackChunkAlicia_website=self.webpackChunkAlicia_website||[]).push([[4207],{3905:(t,n,e)=>{e.d(n,{Zo:()=>d,kt:()=>h});var a=e(7294);function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,a)}return e}function s(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach((function(n){r(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function c(t,n){if(null==t)return{};var e,a,r=function(t,n){if(null==t)return{};var e,a,r={},i=Object.keys(t);for(a=0;a<i.length;a++)e=i[a],n.indexOf(e)>=0||(r[e]=t[e]);return r}(t,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)e=i[a],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(r[e]=t[e])}return r}var o=a.createContext({}),l=function(t){var n=a.useContext(o),e=n;return t&&(e="function"==typeof t?t(n):s(s({},n),t)),e},d=function(t){var n=l(t.components);return a.createElement(o.Provider,{value:n},t.children)},p="mdxType",u={inlineCode:"code",wrapper:function(t){var n=t.children;return a.createElement(a.Fragment,{},n)}},x=a.forwardRef((function(t,n){var e=t.components,r=t.mdxType,i=t.originalType,o=t.parentName,d=c(t,["components","mdxType","originalType","parentName"]),p=l(e),x=r,h=p["".concat(o,".").concat(x)]||p[x]||u[x]||i;return e?a.createElement(h,s(s({ref:n},d),{},{components:e})):a.createElement(h,s({ref:n},d))}));function h(t,n){var e=arguments,r=n&&n.mdxType;if("string"==typeof t||r){var i=e.length,s=new Array(i);s[0]=x;var c={};for(var o in n)hasOwnProperty.call(n,o)&&(c[o]=n[o]);c.originalType=t,c[p]="string"==typeof t?t:r,s[1]=c;for(var l=2;l<i;l++)s[l]=e[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,e)}x.displayName="MDXCreateElement"},5594:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var a=e(7462),r=(e(7294),e(3905));const i={title:"canvas \u5b9e\u7528\u65b9\u6cd5",tags:["canvas"],sidebar_position:1},s="canvas \u5b9e\u7528\u65b9\u6cd5",c={unversionedId:"Canvas/canvas-\u65b9\u6cd5",id:"Canvas/canvas-\u65b9\u6cd5",title:"canvas \u5b9e\u7528\u65b9\u6cd5",description:"canvas\u4e0e\u7ed8\u5236\u9875\u9762\u4e0d\u540c\uff0c\u4e0d\u652f\u6301\u8bbe\u7f6ecss\u5c5e\u6027\uff0c\u4e0d\u652f\u6301\u6587\u5b57\u81ea\u52a8\u6362\u884c\uff0c\u4e0d\u652f\u6301\u5143\u7d20\u81ea\u52a8\u5782\u76f4\u5b9a\u4f4d\uff0c\u6240\u6709\u90fd\u9700\u8981\u8fdb\u884c\u7ed8\u5236\uff0c\u4e8e\u662f\u5bf9\u5e38\u7528\u65b9\u6cd5\u8fdb\u884c\u5c01\u88c5\u5e76\u603b\u7ed3\u3002",source:"@site/docs/5-Canvas/canvas-\u65b9\u6cd5.md",sourceDirName:"5-Canvas",slug:"/Canvas/canvas-\u65b9\u6cd5",permalink:"/Canvas/canvas-\u65b9\u6cd5",draft:!1,tags:[{label:"canvas",permalink:"/tags/canvas"}],version:"current",sidebarPosition:1,frontMatter:{title:"canvas \u5b9e\u7528\u65b9\u6cd5",tags:["canvas"],sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Canvas",permalink:"/category/canvas"},next:{title:"canvas \u5e94\u7528 - \u88c1\u5207\u56fe\u7247",permalink:"/Canvas/canvas-\u88c1\u5207\u56fe\u7247"}},o={},l=[{value:"1\u3001\u7ed8\u5236\u4e00\u4e2a\u6709\u586b\u5145\u8272\u7684\u5706\u89d2\u77e9\u5f62",id:"1\u7ed8\u5236\u4e00\u4e2a\u6709\u586b\u5145\u8272\u7684\u5706\u89d2\u77e9\u5f62",level:2},{value:"2\u3001\u7ed8\u5236\u4e00\u4e2a\u5706\u89d2\u77e9\u5f62\uff0c\u8fb9\u6846",id:"2\u7ed8\u5236\u4e00\u4e2a\u5706\u89d2\u77e9\u5f62\u8fb9\u6846",level:2},{value:"3\u3001\u7ed8\u5236\u81ea\u52a8\u6362\u884c\u6587\u5b57\uff0c\u652f\u6301\u4e2d\u82f1\u6587",id:"3\u7ed8\u5236\u81ea\u52a8\u6362\u884c\u6587\u5b57\u652f\u6301\u4e2d\u82f1\u6587",level:2},{value:"4\u3001\u7ed8\u5236\u4e24\u7aef\u5bf9\u9f50\u7684\u6587\u5b57",id:"4\u7ed8\u5236\u4e24\u7aef\u5bf9\u9f50\u7684\u6587\u5b57",level:2},{value:"5\u3001\u7ed8\u5236\u5706\u5f62\u3001\u5706\u89d2\u56fe\u7247\uff08\u5934\u50cf\uff09",id:"5\u7ed8\u5236\u5706\u5f62\u5706\u89d2\u56fe\u7247\u5934\u50cf",level:2}],d={toc:l},p="wrapper";function u(t){let{components:n,...e}=t;return(0,r.kt)(p,(0,a.Z)({},d,e,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"canvas-\u5b9e\u7528\u65b9\u6cd5"},"canvas \u5b9e\u7528\u65b9\u6cd5"),(0,r.kt)("p",null,"canvas\u4e0e\u7ed8\u5236\u9875\u9762\u4e0d\u540c\uff0c\u4e0d\u652f\u6301\u8bbe\u7f6ecss\u5c5e\u6027\uff0c\u4e0d\u652f\u6301\u6587\u5b57\u81ea\u52a8\u6362\u884c\uff0c\u4e0d\u652f\u6301\u5143\u7d20\u81ea\u52a8\u5782\u76f4\u5b9a\u4f4d\uff0c\u6240\u6709\u90fd\u9700\u8981\u8fdb\u884c\u7ed8\u5236\uff0c\u4e8e\u662f\u5bf9\u5e38\u7528\u65b9\u6cd5\u8fdb\u884c\u5c01\u88c5\u5e76\u603b\u7ed3\u3002"),(0,r.kt)("h2",{id:"1\u7ed8\u5236\u4e00\u4e2a\u6709\u586b\u5145\u8272\u7684\u5706\u89d2\u77e9\u5f62"},"1\u3001\u7ed8\u5236\u4e00\u4e2a\u6709\u586b\u5145\u8272\u7684\u5706\u89d2\u77e9\u5f62"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// \u6709\u586b\u5145\u8272\n/**\u7ed8\u5236\u4e00\u4e2a\u6709\u586b\u5145\u8272\u7684\u5706\u89d2\u77e9\u5f62 \n  *@param ctx:canvas\u7684\u4e0a\u4e0b\u6587\u73af\u5883 \n  *@param x:\u5de6\u4e0a\u89d2x\u8f74\u5750\u6807 \n  *@param y:\u5de6\u4e0a\u89d2y\u8f74\u5750\u6807 \n  *@param width:\u77e9\u5f62\u7684\u5bbd\u5ea6 \n  *@param height:\u77e9\u5f62\u7684\u9ad8\u5ea6 \n  *@param radius:\u5706\u7684\u534a\u5f84 \n  *@param fillColor:\u586b\u5145\u989c\u8272 \n**/\nexport function fillRoundRect(ctx, x, y, width, height, radius, fillColor) {\n  if (2 * radius > width || 2 * radius > height) { return false; }\n  ctx.save();\n  ctx.translate(x, y);\n  //\u7ed8\u5236\u5706\u89d2\u77e9\u5f62\u7684\u5404\u4e2a\u8fb9  \n  drawRoundRectPath(ctx, width, height, radius);\n  ctx.setFillStyle(fillColor || "#fff")\n  ctx.fill();\n  ctx.restore();\n}\n\n// \u7ed8\u5236\u65b9\u6cd5\n/**\u7ed8\u5236\u5706\u89d2\u77e9\u5f62\n  *@param ctx:canvas\u7684\u4e0a\u4e0b\u6587\u73af\u5883 \n  *@param width:\u77e9\u5f62\u7684\u5bbd\u5ea6 \n  *@param height:\u77e9\u5f62\u7684\u9ad8\u5ea6 \n  *@param radius:\u5706\u7684\u534a\u5f84 \n**/\nexport function drawRoundRectPath(ctx, width, height, radius) {\n  ctx.beginPath(0);\n  //\u4ece\u53f3\u4e0b\u89d2\u987a\u65f6\u9488\u7ed8\u5236\uff0c\u5f27\u5ea6\u4ece0\u52301/2PI  \n  ctx.arc(width - radius, height - radius, radius, 0, Math.PI / 2);\n  //\u77e9\u5f62\u4e0b\u8fb9\u7ebf  \n  ctx.lineTo(radius, height);\n  //\u5de6\u4e0b\u89d2\u5706\u5f27\uff0c\u5f27\u5ea6\u4ece1/2PI\u5230PI  \n  ctx.arc(radius, height - radius, radius, Math.PI / 2, Math.PI);\n  //\u77e9\u5f62\u5de6\u8fb9\u7ebf  \n  ctx.lineTo(0, radius);\n  //\u5de6\u4e0a\u89d2\u5706\u5f27\uff0c\u5f27\u5ea6\u4ecePI\u52303/2PI  \n  ctx.arc(radius, radius, radius, Math.PI, Math.PI * 3 / 2);\n  //\u4e0a\u8fb9\u7ebf  \n  ctx.lineTo(width - radius, 0);\n  //\u53f3\u4e0a\u89d2\u5706\u5f27  \n  ctx.arc(width - radius, radius, radius, Math.PI * 3 / 2, Math.PI * 2);\n  //\u53f3\u8fb9\u7ebf  \n  ctx.lineTo(width, height - radius);\n  ctx.closePath();\n}\n')),(0,r.kt)("h2",{id:"2\u7ed8\u5236\u4e00\u4e2a\u5706\u89d2\u77e9\u5f62\u8fb9\u6846"},"2\u3001\u7ed8\u5236\u4e00\u4e2a\u5706\u89d2\u77e9\u5f62\uff0c\u8fb9\u6846"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/**\u8be5\u65b9\u6cd5\u7528\u6765\u7ed8\u5236\u5706\u89d2\u77e9\u5f62 \n *@param ctx:canvas\u7684\u4e0a\u4e0b\u6587\u73af\u5883 \n  *@param x:\u5de6\u4e0a\u89d2x\u8f74\u5750\u6807 \n  *@param y:\u5de6\u4e0a\u89d2y\u8f74\u5750\u6807 \n  *@param width:\u77e9\u5f62\u7684\u5bbd\u5ea6 \n  *@param height:\u77e9\u5f62\u7684\u9ad8\u5ea6 \n  *@param radius:\u5706\u7684\u534a\u5f84 \n  *@param lineWidth:\u7ebf\u6761\u7c97\u7ec6 \n  *@param strokeColor:\u7ebf\u6761\u989c\u8272 \n  **/\nexport function strokeRoundRect(ctx, x, y, width, height, radius, /*optional*/ lineWidth, /*optional*/ strokeColor) {\n  //\u5706\u7684\u76f4\u5f84\u5fc5\u7136\u8981\u5c0f\u4e8e\u77e9\u5f62\u7684\u5bbd\u9ad8          \n  if (2 * radius > width || 2 * radius > height) { return false; }\n  ctx.save();\n  ctx.translate(x, y);\n  //\u7ed8\u5236\u5706\u89d2\u77e9\u5f62\u7684\u5404\u4e2a\u8fb9  \n  drawRoundRectPath(ctx, width, height, radius);\n  ctx.lineWidth = lineWidth || 1; //\u82e5\u662f\u7ed9\u5b9a\u4e86\u503c\u5c31\u7528\u7ed9\u5b9a\u7684\u503c\u5426\u5219\u7ed9\u4e88\u9ed8\u8ba4\u503c2  \n  ctx.strokeStyle = strokeColor;\n  ctx.stroke();\n  ctx.restore();\n}\n")),(0,r.kt)("h2",{id:"3\u7ed8\u5236\u81ea\u52a8\u6362\u884c\u6587\u5b57\u652f\u6301\u4e2d\u82f1\u6587"},"3\u3001\u7ed8\u5236\u81ea\u52a8\u6362\u884c\u6587\u5b57\uff0c\u652f\u6301\u4e2d\u82f1\u6587"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"}," /**canvas\u7ed8\u5236\u6587\u5b57\u6362\u884c\n  *@param ctx:canvas\u7684\u4e0a\u4e0b\u6587\u73af\u5883 \n  *@param text:\u6587\u5b57\u5185\u5bb9\n  *@param x:x\u5750\u6807 \n  *@param y:y\u5750\u6807 \n  *@param maxWidth:\u6700\u5927\u5bbd\u5ea6\n  *@param lineHeight:\u6587\u5b57\u884c\u9ad8 \n  *@param isEng:\u662f\u5426\u4e3a\u82f1\u6587 \n  *@param isJustify:\u662f\u5426\u9700\u8981\u4e24\u7aef\u5bf9\u9f50\n**/\nexport function wrapText(ctx, text, x, y, maxWidth=300, lineHeight=20, isEng=false, isJustify=true) {\n  if (typeof text != 'string' || typeof x != 'number' || typeof y != 'number') {\n    return;\n  }\n\n  if (typeof maxWidth == 'undefined') {\n    maxWidth = 300;\n  }\n\n  // \u5b57\u7b26\u5206\u9694\u4e3a\u6570\u7ec4\n  const splitStr = isEng? ' ': '';\n  const arrText = text.split(splitStr);\n  let line = '';\n  const splitStrWidth = ctx.measureText(splitStr).width;\n\n  for (let n = 0; n < arrText.length; n++) {\n    const testLine = line + arrText[n] + splitStr;\n    const metrics = ctx.measureText(testLine);\n    const testWidth = metrics.width;\n    if (testWidth > maxWidth && n > 0) {\n\n      drawJustifiedText(ctx, line, x, y, maxWidth, false, splitStrWidth, isJustify);\n      line = arrText[n]+splitStr;\n      y += lineHeight;\n    } else {\n      line = testLine;\n    }\n  }\n  drawJustifiedText(ctx, line, x, y, maxWidth, true, splitStrWidth, isJustify);\n}\n")),(0,r.kt)("h2",{id:"4\u7ed8\u5236\u4e24\u7aef\u5bf9\u9f50\u7684\u6587\u5b57"},"4\u3001\u7ed8\u5236\u4e24\u7aef\u5bf9\u9f50\u7684\u6587\u5b57"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"}," /**canvas\u7ed8\u5236\u4e24\u7aef\u5bf9\u9f50\u6587\u5b57\n  *@param ctx:canvas\u7684\u4e0a\u4e0b\u6587\u73af\u5883 \n  *@param text:\u6587\u5b57\u5185\u5bb9\n  *@param x:x\u5750\u6807 \n  *@param y:y\u5750\u6807 \n  *@param maxWidth:\u6700\u5927\u5bbd\u5ea6\n  *@param isLastLine:\u662f\u5426\u4e3a\u6700\u540e\u4e00\u884c\uff0c\u6700\u540e\u4e00\u884c\u4e0d\u5c45\u4e2d \n  *@param splitStrWidth:\u5206\u9694\u7b26\u7684\u5bbd\u5ea6\uff0c\u4e2d\u6587\u5206\u9694\u7b26\u662f'', \u82f1\u6587\u5206\u5272\u7b26\u662f' '\n  *@param isJustify:\u662f\u5426\u9700\u8981\u4e24\u7aef\u5bf9\u9f50\n**/\nfunction drawJustifiedText(ctx, text, x, y, maxWidth, isLastLine, splitStrWidth, isJustify){\n  // \u6700\u540e\u4e00\u884c\u5c45\u5de6\n  if(isLastLine||!isJustify) {\n    ctx.fillText(text, x, y);\n    return;\n  }\n  const lineText = text.trim();\n  const words = lineText.split(' ');\n  const numWords = words.length;\n  const textWidth = ctx.measureText(lineText).width;\n  const spaceWidth = (maxWidth - textWidth) / Math.max(1, numWords - 1)+splitStrWidth;\n  for (let i = 0; i < numWords; i++) {\n    const word = words[i];\n    ctx.fillText(word, x, y);\n    x += ctx.measureText(word).width + spaceWidth;\n  }\n}\n")),(0,r.kt)("h2",{id:"5\u7ed8\u5236\u5706\u5f62\u5706\u89d2\u56fe\u7247\u5934\u50cf"},"5\u3001\u7ed8\u5236\u5706\u5f62\u3001\u5706\u89d2\u56fe\u7247\uff08\u5934\u50cf\uff09"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// h5\u52a0\u8f7d\u56fe\u7247\uff0c\u5c0f\u7a0b\u5e8f\u4e0d\u652f\u6301Image\nhandleGetImage(src) {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.src = src;\n    img.onload=function() {\n      resolve(src)\n    }\n  })\n}\n\n// \u5c0f\u7a0b\u5e8f\u7248\u672c\nhandleGetImage(src) {\n  return new Promise((resolve) => {\n    wx.getImageInfo({\n      src,\n      success: (res) => {\n        resolve(res.path)\n      },\n      fail: (res)=>{\n        resolve(false);\n      }\n    })\n  })\n}\n\nconst path = await this.handleGetImage('xxx');\ncontext.save()\ncontext.beginPath();\n// \u7ed8\u5236\u5706\uff0c\u6216\u8005\u901a\u8fc7arc\u548clineTo\u6df7\u5408\u7ed8\u5236\u5706\u89d2\u6846\ncontext.arc(295, 79, 35, 0, Math.PI * 2);\ncontext.closePath()\ncontext.fill();\ncontext.clip(); // \u88c1\u526a\ncontext.drawImage(path, 260, 44, 70, 70) // \u7ed8\u5236\u56fe\u7247\ncontext.restore()\n")))}u.isMDXComponent=!0}}]);